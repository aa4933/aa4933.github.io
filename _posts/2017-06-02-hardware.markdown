---
layout:     post
title:      "影响mysql性能的因素-硬件篇"
subtitle:   "Mysql"
date:       2017-05-21 10:52:00
author:     "wuilly"
header-img: "http://ww1.sinaimg.cn/large/006tKfTcgy1fj5bs20tvxj30dw0960td.jpg"
tags:
    - Mysql
---
> 'About hardware'

### 服务器硬件的选择


>     也许你会觉得，硬件这有啥好了解的，上最贵的e7-8890 v2 频率高，核心多，一个cpu4w+，但是现实往往是很残酷的，没钱！这个时候预算只有2w块的时候，采购人员会问技术人员一个基本的问题：要买什么cpu，要买什么硬盘这个时候，你就需要考虑几个问题

#### cpu的选择

- [ ] 你的请求处理是否是密集型的，当前版本mysql是不支持多cpu处理sql的，这个时候你需要更快的cpu，
- [ ] 你要确定自己请求并发量是否够多，如果很大的，你就需要多个核心的cpu处理，新版mysql会cpu支持比较好
- [ ] 记住不要使用64位mysql却使用32位系统
- [ ] 可以根据数据库大小确定购买内存大小

#### 硬盘的选择与搭配

> 使用RAID来增加传统机械硬盘的能力,RAID是磁盘冗余队列的简称，打个比方就是，天罡北斗阵，我一个人不行，我凑108个人干你，来保证数据的完整性
- RAID0，这是一种很早的模式，只需要2磁盘就能使用，成本低，没有冗余与错误修复能力
- RAID1，又叫磁盘镜像，在写入一个磁盘的同时，生产一个镜像磁盘，不影响性能的情况下，保证数据的可靠
- RAID5，又叫奇偶校验磁盘阵列，通过分布式奇偶校验分散数据，任何一个磁盘实效，另外几个就能修复出实效的磁盘，但是一旦毁坏2块，就没办法了
- RAID10，先对磁盘做RAID1,再做RAID0，对于RAID5更快更好，除了成本高几乎完美

下面是一个选择图，可以根据情况选择

![](http://ww1.sinaimg.cn/large/006tNbRwgy1fgdwshtdzuj30vo0acmyw.jpg)

* 机械硬盘

    稳定，便宜

* 固态硬盘

    在服务器上解决单线程io瓶颈几乎是最好的选择，所以有钱就上固态，这句话不是吹的，用过固态硬盘的同学都知道，固态硬盘和机械硬盘，就是一个开飞机，一个坐火车，当然了，这个钱花的也多，ssd也是支持RAID的这里会有一个场景问题

>当公司只有一个固态硬盘的时候，我们要用在从服务器还是主服务器

    答案：从服务器
    从服务器写入是单线程，为了更好的响应解决单线程负载io，我们使用从服务器是最好的选择

* PCI-E SSD

    这个东西会占用一部分的内存和cpu，但是整体速度比ssd还要快，一般我们不在PCI-E上使用RAID，成本会很大

#### 网络以及网络存储的影响

* 网络存储
        一般分为两种SAN与NAS
        比较坑爹的是随机读写还不如RAID本地磁盘
        而且涉及多个方面，出现问题，解决时间很长
        所以我们一般用于
        数据库备份
        防止员工干一些坑爹的事情报复，导致公司完全瘫痪的情况

* 网络对性能的影响    
        这个一般表现在带宽和延迟，经常打游戏的同学会比较了解
        延迟：网络质量差经常发生丢包的情况下，反复发包，结果造成网络爆炸
        带宽：网络总量，是瓶颈因素，如果量过大，会挤压整个网络导致瘫痪


* 解决方案
        采用高性能和高带宽的交换机，网络接口设备
        对多个网卡进行绑定，增强可用性和带宽
        尽可能进行内外网隔离，一般不会暴露数据库在外网
