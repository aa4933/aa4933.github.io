---
layout:     post
title:      "小米手机证书安装和思考"
subtitle:   "year"
date:       2020-05-25 15:27:00
author:     "wuilly"
header-img: "https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1516777063737&di=a86a9881000f70190aaffe6953eec4f3&imgtype=0&src=http%3A%2F%2Fimg.article.pchome.net%2F00%2F28%2F07%2F58%2Fpic_lib%2Fwm%2F1920_1200car_1002.jpg"
tags:
    - WU
---
> 'About WU'


### 生活

最近生活慢慢开始被解决问题

慢慢步入了正轨了

希望后面一件一件的破事情都能被解决掉

最后能有一个完美的结尾

虽然现在可能难度很大，但终究是要努力一下

### 小米手机

说起小米手机，肯定都不陌生，最近我也是闲着无聊，把之前的破手机换掉了

小米5s太卡了，不得不切换到了新的手机，新手机redmi note8 pro

然而我还是年轻了，我轻视了我是一个开发者的事实

首先新手机是miui11，也就是安卓10的内核

那么就遇到了很大的问题，无法抓包

这个问题我当初在小米5s上面也遇到过，不过我当时处理掉了，今天我才想起来，我根本没有把

处理的过程留下来，给我后面减少一些麻烦

毕竟最近google上不去，很烦，很多资料都找不全了

### 先说思路

抓包的原理

本质就是，手机-电脑-服务器

让手机的网络多走一个代理

代理可以分成很多种，有一些是比较纯的拦截转发，还有一些是属于代处理

vpn也是属于这一类，不过现在意义不大，因为vpn都会被检测到，而且服务器封的不要不要的

所以我们的需求就是，让手机可以走代理

这样就衍生出了2种方案

wifi方案

蜂窝方案

wifi方案的话，就很简单，设置一下代理就好了

蜂窝方案的话，也就是俗称的apn，本质就是多开一条路让蜂窝先走

开起来都很简单

但是后续才是真正麻烦的

当你开启这个的时候，基本上http协议的包，就畅通无阻了

能刷的都能抓到

但是如果是https，则需要安装证书

本质上就是不相信代理，手机会因为安全，把这类证书屏蔽

以前很简单，按安卓7以前，只需要安装，下一步，就结束了

安卓7以后，变得极其麻烦，相比较而言ios比较简单

我的版本是安卓10

1.我需要解bl锁

2.我需要root

3.我需要安装证书

4.我需要把证书迁移到系统级别的CA里面

/system/etc/security/cacerts （之前操作的具体目录忘记了，只有baidu所以只能找到这个）

也有人用adb push 

https://cloud.tencent.com/developer/article/1527037

流程大概就是这样

ios的话，安装，信任一下，就可以了，但是ios蜂窝代理比较麻烦，需要去改某些东西

也算是各有麻烦的地方

我最后是没去解锁，因为解锁现在需要删除所有的用户信息，我实在不想重装系统了，太麻烦了

我应该会去研究一下把ios的蜂窝代理开起来，或许流程会简单一点

https://www.cnblogs.com/storyline/articles/10261447.html

这个是具体流程，简单来说就是

1.找到ios官方的配置生成器

2.safari打开安装

3.选择代理到这个上面，就可以了，选择的话在具体中国电信/移动的位置

